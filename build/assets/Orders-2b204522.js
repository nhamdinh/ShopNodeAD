import{j as e,P as m,C as xe}from"./mui-8cc0f558.js";import{T as me,r as i,p as F}from"./antd-18c18a77.js";import{P as ue}from"./PageHeader-5ed338fa.js";import{C as ge}from"./CalendarSelector-c8936f23.js";import{S as K}from"./index-a7e28cc4.js";import{S as A,_ as he,a as M,g as G,h as je,k as q,n as fe,O as z,p as _e,q as O,R as be,T as S}from"./index-88de12ef.js";import{L}from"./LabeledProgressBar-04ba0255.js";import{C as ve}from"./Counter-f6fae9cb.js";import{S as I}from"./SubmenuTrigger-a96777a5.js";import{P as Ne}from"./Pagination-2bfb5f72.js";import{R as V}from"./RatingStars-4e5e91c0.js";import{d as Z}from"./helpers-8c6e04da.js";import{E as ye}from"./Empty-8d8c6e6e.js";import{u as Se}from"./usePagination-0eed2831.js";import{f as Pe}from"./commonFunction-6a88a2ca.js";import"./DocumentTitle-53b49d61.js";import"./index-3bcee3ff.js";import"./ProgressBar-8688e693.js";var u=256,H=[],B=256,P;for(;u--;)H[u]=(u+256).toString(16).substring(1);function we(t){var r=0,c=t||11;if(!P||u+c>B*2)for(P="",u=0;r<B;r++)P+=H[Math.random()*256|0];return P.substring(u,u+++c)}const Ce=()=>e.jsxs(A,{className:"card flex flex-col gap-4",children:[e.jsx("h5",{children:"Average Rate (%)"}),e.jsxs("div",{className:"flex flex-col gap-2.5",children:[e.jsx(L,{color:"header",label:"Product Views",value:87,displayValue:"87%"}),e.jsx(L,{color:"header",label:"Cart Abandonment Rate",value:23,displayValue:"23%"})]})]}),b=({icon:t,color:r="accent",title:c="Lorem ipsum",count:n=0})=>e.jsxs(A,{className:"card !pb-5",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("div",{className:"badge-icon badge-icon--sm",style:{backgroundColor:`var(--${r})`},children:t}),e.jsx(I,{})]}),e.jsxs("h6",{className:"mt-[28px] mb-2.5",children:[e.jsx("span",{className:"xl:hidden 2xl:inline",children:"Orders "}),c]}),e.jsx(ve,{className:"h3",num:n})]});b.propTypes={icon:m.node,color:m.oneOf(["accent","green","red","badge-status-bg"]),title:m.string,count:m.number};const Re=he(me).withConfig({displayName:"styles__StyledTable",componentId:"sc-gvbfgj-0"})(["margin-bottom:30px;flex-grow:1;.ant-table{padding:0 26px;}.ant-table-thead .ant-table-cell{padding:33px 0 28px !important;background:var(--widget);&:last-child{text-align:right;}}.ant-table-row:last-child .ant-table-cell{border-bottom:0;}.ant-table-row .ant-table-cell{padding:32px 0;}.ant-table-cell{border-color:var(--input-border) !important;}@media (min-width:1536px){.product-cell{width:23%;}}"]),X=({order:t,activeCollapse:r,handleCollapse:c})=>{const n=M().width<375,p=t.payment.totalAmountPay===t.payment.received?"Fully paid":t.payment.totalAmountPay>t.payment.received&&t.payment.received!==0?"Partially paid":"Unpaid";return e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"subheading-2",children:["#",t._id]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{className:`collapse-btn ${r===t.SKU?"active":""}`,"aria-label":"Toggle view",onClick:()=>c(t.SKU),children:e.jsx("i",{className:"icon icon-caret-down-solid"})}),e.jsx(G,{to:"/product-editor","aria-label":"Edit",children:e.jsx("i",{className:"icon icon-pen-to-square-regular"})}),e.jsx(I,{})]})]}),e.jsx(xe,{in:r===t.SKU,children:e.jsx("table",{className:"basic-table",children:e.jsxs("tbody",{children:[e.jsx("tr",{children:e.jsx("td",{colSpan:2,children:"Product"})}),e.jsx("tr",{children:e.jsx("td",{colSpan:2,children:e.jsxs("div",{className:"flex gap-6",children:[e.jsx("div",{className:"img-wrapper w-[70px] h-[64px] flex items-center justify-center",children:e.jsx("img",{src:t.product.product_thumb_small??t.product.product_thumb,alt:t.product.name})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h5",{className:"text-sm mb-1.5",children:t.product.name}),e.jsxs("div",{className:"flex flex-col gap-1 text-sm text-body-text",children:[e.jsxs("p",{children:["Regular price: $",t.product.product_price]}),t.product.product_original_price&&e.jsxs("p",{children:["Sale price: $",t.product.product_original_price]})]})]})]})})}),e.jsxs("tr",{children:[e.jsx("td",{children:"SKU"}),e.jsx("td",{children:t.SKU})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"Category"}),e.jsx("td",{className:"capitalize",children:t.product_type})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"Payment"}),e.jsx("td",{children:e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("span",{className:"font-heading font-bold text-header",children:[p!=="Fully paid"&&`$${t.payment.received} / from `,"$",t.payment.totalAmountPay]}),e.jsx("span",{children:p})]})})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"Status"}),e.jsx("td",{className:"capitalize",children:n?t.status:e.jsx("span",{className:"badge-status badge-status--lg",style:{backgroundColor:`var(--${Z(t.status)})`,width:"100%"},children:t.status})})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"Rate"}),e.jsx("td",{children:n?t.product_ratings:e.jsx("div",{className:"flex justify-center",children:e.jsx(V,{rating:t.product_ratings})})})]})]})})})]})};X.propTypes={order:m.object.isRequired,activeCollapse:m.string.isRequired,handleCollapse:m.func.isRequired};const Ee=({category:t,sort:r,ordersProduct:c,categories:n})=>{const{width:p}=M(),[f,g]=i.useState(""),l=t.value==="all"?c:c.filter(s=>s.product_categories.includes(t.value)),o=Se({data:(()=>{switch(r.value){default:case"default":return l;case"a-z":return l.sort((s,a)=>s.product.product_name.localeCompare(a.product.product_name));case"z-a":return l.sort((s,a)=>a.product.product_name.localeCompare(s.product.product_name));case"rating-high-to-low":return l.sort((s,a)=>a.product_ratings-s.product_ratings);case"rating-low-to-high":return l.sort((s,a)=>s.product_ratings-a.product_ratings)}})(),limit:5});i.useEffect(()=>{o.goToPage(0),g("")},[t,r]),i.useEffect(()=>{g("")},[o.currentPage,p]);const w=s=>{g(f===s?"":s)},_=s=>n.find(a=>a.value===s),T=[{title:"# order",dataIndex:"_id",width:"100px",render:s=>e.jsxs("div",{className:"subheading-2 w80px line__clamp__2",children:["#",s]})},{title:"Product",dataIndex:"product",className:"product-cell",render:s=>e.jsxs("div",{className:"flex gap-6",children:[e.jsx("div",{className:"img-wrapper w-[70px] h-[64px] flex items-center justify-center shrink-0",children:e.jsx("img",{src:(s==null?void 0:s.product_thumb_small)??(s==null?void 0:s.product_thumb),alt:s.product_name})}),e.jsxs("div",{className:"flex-col hidden 2xl:flex",children:[e.jsx("h5",{className:"text-sm max-w-[195px] mb-1.5 line__clamp__2",children:s.product_name}),e.jsxs("div",{className:"flex flex-col gap-1 text-sm",children:[e.jsxs("p",{children:["Regular price: $",s.product_price]}),s.product_original_price&&e.jsxs("p",{children:["Sale price: $",s.product_original_price]})]})]})]}),responsive:["lg"]},{title:"SKU",dataIndex:"product_id",render:s=>e.jsx("div",{className:"w80px line__clamp__2",children:s})},{title:"Category",dataIndex:"product_categories",render:s=>e.jsx("div",{className:"flex items-center gap-4 direction__column",children:s.map(a=>{var v,N,y;return e.jsxs("div",{className:"flex items-center gap-4 ",children:[e.jsx("div",{className:`badge-icon badge-icon--sm bg-${(v=_(a))==null?void 0:v.color}`,children:e.jsx("i",{className:`${(N=_(a))==null?void 0:N.icon} text-base`})}),e.jsx("span",{className:"label-text capitalize",children:(y=_(a))==null?void 0:y.label})]})})}),responsive:["lg"]},{title:"Payment",dataIndex:"payment",render:s=>{const a=s.totalAmountPay===s.received?"Fully paid":s.totalAmountPay>s.received&&s.received!==0?"Partially paid":"Unpaid";return e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("span",{className:"font-heading font-bold text-header",children:[a!=="Fully paid"&&`$${s.received} / from `,"$",Pe(s.totalAmountPay)]}),e.jsx("span",{children:a})]})}},{title:"Order Status",dataIndex:"status",render:s=>e.jsx("span",{className:"badge-status badge-status--lg",style:{backgroundColor:`var(--${Z(s)})`},children:s})},{title:"Rate",dataIndex:"product_ratings",render:s=>e.jsx(V,{rating:s}),responsive:["xl"]},{title:"Actions",dataIndex:"actions",width:"70px",render:()=>e.jsxs("div",{className:"flex items-center justify-end gap-11",children:[e.jsx(G,{to:"/product-editor","aria-label":"Edit",children:e.jsx("i",{className:"icon icon-pen-to-square-regular text-lg leading-none"})}),e.jsx(I,{})]})}];return e.jsxs(A,{className:"flex flex-col flex-1 w-full",children:[p>=768?e.jsx(Re,{columns:T,dataSource:o.currentItems(),pagination:!1,locale:{emptyText:e.jsx(ye,{text:"No orders found"})},rowKey:s=>s.SKU}):e.jsx("div",{className:"flex flex-1 flex-col gap-5 mb-[26px]",children:o.currentItems().map(s=>e.jsx(X,{order:s,activeCollapse:f,handleCollapse:w},s.SKU))}),o.maxPage>1&&e.jsx(Ne,{pagination:o})]})},Xe=()=>{const{t}=je(),r=q(fe),c=[{value:"all",label:"All Products"},...r],[n,p]=i.useState(c[0]),[f,g]=i.useState(z[0]),l=q(_e),[D,o]=i.useState(0),[w,_]=i.useState(0),[T,s]=i.useState(0),[a,v]=i.useState(0),[N,y]=i.useState(0),[W,J]=i.useState([]),[C,$]=i.useState({shopId:l==null?void 0:l._id,limit:O,page:1});i.useEffect(()=>{$({shopId:l==null?void 0:l._id,limit:O,page:1})},[l]);const[Q,{isLoading:Y,error:Oe}]=be(),U=async()=>{const h=await Q(C),j=h==null?void 0:h.data;if(j){const{isPaid:ee,isDelivered:se,isCanceled:te,isRefunded:ae,isNotPaid:le,orders:k}=j==null?void 0:j.metadata;o(ee),_(se),s(te),v(ae),y(le);const ie=k.flatMap(d=>d.itemProducts),re=({isPaid:d,isDelivered:R,isCanceled:x,isRefunded:E})=>E===!0?"refunded":x===!0?"cancelled":R===!0?"confirmed":"completed",ce=ie.map((d,R)=>{const x=k.find(pe=>pe._id===d.order_id),{isPaid:E,isDelivered:de,isCanceled:ne,isRefunded:oe}=x;return{...x,product_id:d._id,product_ratings:d.product_ratings,product_type:d.product_type,product_categories:d.product_categories,payment:{totalAmountPay:x.totalAmountPay,received:x.isPaid?x.totalAmountPay:0},status:re({isPaid:E,isDelivered:de,isCanceled:ne,isRefunded:oe}),SKU:we()+R,product:d}});J(ce)}};return i.useEffect(()=>{C.shopId&&U()},[C]),e.jsxs(e.Fragment,{children:[e.jsx(ue,{title:t("Orders"),isFetching:Y,cb_refetch:U}),e.jsxs("div",{className:"flex flex-col flex-1 gap-5 md:gap-[26px]",children:[e.jsxs("div",{className:`w-full grid grid-cols-1 gap-4 md:grid-cols-2 md:gap-[26px] lg:grid-cols-4 lg:items-end
                     xl:grid-cols-6`,children:[e.jsx(ge,{wrapperClass:"lg:max-w-[275px] lg:col-span-2 xl:col-span-4",id:"ordersPeriodSelector",cb_setRangeDate:h=>{const j={gte:F(h[0]).format(),lt:F(h[1]).format()};$({shopId:l==null?void 0:l._id,limit:O,page:1,createdAt:j})}}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 md:gap-[26px] md:col-span-2",children:[e.jsx(K,{value:n,options:c,onChange:p,placeholder:"Product category"}),e.jsx(K,{value:f,options:z,onChange:g,placeholder:"Default sorting"})]})]}),e.jsxs("div",{className:"w-full widgets-grid grid-cols-1 xl:grid-cols-6",children:[e.jsx("div",{className:"xl:col-span-2",children:e.jsx(Ce,{})}),e.jsxs("div",{className:"widgets-grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 xl:col-span-4",children:[e.jsx(b,{title:"Not Paid",count:N*S,color:"red",icon:e.jsx("i",{className:"icon-ban-solid"})}),e.jsx(b,{title:"Paid",count:D*S,icon:e.jsx("i",{className:"icon-check-to-slot-solid"})}),e.jsx(b,{title:"Delivered",count:w*S,color:"green",icon:e.jsx("i",{className:"icon-list-check-solid"})}),e.jsx(b,{title:"Refunded",count:a*S,color:"badge-status-bg",icon:e.jsx("i",{className:"icon-rotate-left-solid"})})]})]}),e.jsx(Ee,{ordersProduct:W,category:n,sort:f,categories:r})]})]})};export{Xe as default};
