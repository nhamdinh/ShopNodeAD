import{j as s}from"./mui-8cc0f558.js";import{P as Y}from"./PageHeader-39c77a7f.js";import{C as j}from"./CustomersInfobox-bd877e5e.js";import{S as h,e as F,a as L,V as W,W as K,X as v,y as R,h as G,k as U,p as z,Y as H}from"./index-5a88363d.js";import{P as J}from"./ProgressBar-f1d7d0a7.js";import{g as Q}from"./helpers-8c6e04da.js";import{S as X}from"./index-92d70eeb.js";import{S as Z}from"./SubmenuTrigger-a96777a5.js";import{R as N}from"./RatingStars-5f12d36a.js";import{T as q}from"./Timestamp-d79ab090.js";import{u as ee}from"./web-2727bf52.js";import{r as n,p as se}from"./antd-18c18a77.js";import{P as re}from"./Pagination-2bfb5f72.js";import{u as le}from"./usePaginationApi-88bb9964.js";import{C as ce}from"./Counter-f6fae9cb.js";import"./DocumentTitle-53b49d61.js";const ie=({rate:e=0,value:r=0})=>s.jsxs("div",{className:"flex items-center gap-2.5",children:[s.jsxs("span",{className:"flex items-center gap-1 label-text leading-none w-[30px]",children:[e," ",s.jsx("i",{className:"icon-star-solid text-yellow"})]}),s.jsx("div",{className:"flex-1",children:s.jsx(J,{value:r,color:"yellow"})}),s.jsxs("span",{className:"!text-header label-text w-[42px] text-right",children:[r,"%"]})]}),ne=({data:e=[]})=>s.jsx(h,{className:"card min-h-[182px] !py-5 flex flex-col justify-between col-span-2",children:e.map((r,l)=>s.jsx(ie,{rate:r==null?void 0:r.rate,value:Q(e,r==null?void 0:r.value)},l))}),w={name:"John",lastName:"Doe",email:"email@domain.com",rating:5,avatar:"https://via.placeholder.com/63x63",comment:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla vitae diam eu nulla tincidunt tincidunt.",createdAt:new Date},S=({data:e=w,wrapperClass:r})=>s.jsxs("div",{className:`flex items-center ${r}`,children:[s.jsx("img",{className:"bg-input-border shrink-0 w-10 h-10 rounded-md md:w-[63px] md:h-[63px]",src:e==null?void 0:e.avatar,alt:`${e==null?void 0:e.name} ${e==null?void 0:e.lastName}`,width:63,height:63}),s.jsxs("div",{className:"flex flex-col gap-1.5 md:gap-2.5",children:[s.jsxs("h6",{className:"truncate max-w-[120px] xs:max-w-[180px]",children:[e==null?void 0:e.name," ",e==null?void 0:e.lastName]}),s.jsx("a",{className:"comment-btn",href:`mailto:${e==null?void 0:e.email}`,children:s.jsx("span",{className:"truncate max-w-[120px] xs:max-w-[180px]",children:e==null?void 0:e.email})})]})]}),oe=({data:e=w,wrapperClass:r})=>s.jsxs("div",{className:`flex items-center ${r}`,children:[s.jsx("img",{className:"bg-input-border shrink-0 w-10 h-10 rounded-md md:w-[63px] md:h-[63px]",src:(e==null?void 0:e.product_thumb_small)??(e==null?void 0:e.product_thumb),alt:`${e==null?void 0:e.product_name}`,width:63,height:63}),s.jsxs("div",{className:"flex flex-col gap-1.5 md:gap-2.5",children:[s.jsx("h6",{className:"truncate max-w-[120px] xs:max-w-[180px]",children:e==null?void 0:e.product_name}),s.jsx("div",{className:"comment-btn",children:s.jsxs("span",{className:"truncate max-w-[120px] xs:max-w-[180px]",children:["$ ",e==null?void 0:e.product_price]})})]})]}),te=({data:e=w,index:r=0})=>{const{theme:l}=F(),{width:m}=L(),[t,{width:u}]=ee(),o=l==="light"?"var(--body)":"rgba(39,50,65,.2)",[i,c]=n.useState(!1);return n.useEffect(()=>{c(!1)},[m]),s.jsxs(h,{index:r,children:[s.jsx("div",{className:"p-5",style:{backgroundColor:r%2===0?o:"var(--widget)"},children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(S,{data:e==null?void 0:e.userId,wrapperClass:"gap-5 md:gap-[30px] md:w-[300px]"}),s.jsx(oe,{data:e==null?void 0:e.productId,wrapperClass:"gap-5 md:gap-[30px] md:w-[300px]"}),m>=768&&s.jsxs("div",{className:"flex items-center gap-[18px] xl:ml-[30px] xl:mr-10 xl:w-[200px]",children:[s.jsx(N,{rating:e==null?void 0:e.rating}),s.jsx("span",{className:"label-comment",children:e==null?void 0:e.rating})]}),m>=1280&&s.jsxs("div",{className:`flex flex-1 gap-5 bg-input-bg border border-input-border h-20 rounded-md\r
                             max-w-[588px] p-4 overflow-hidden`,children:[s.jsx("div",{className:"flex-1 max-w-[513px]",ref:t,children:s.jsx(W,{className:"flex-1",text:e==null?void 0:e.comment,width:u})}),s.jsx("button",{className:"self-start icon comment-[18px] mt-1",onClick:()=>c(!0),"aria-label":"See details",children:s.jsx("i",{className:"icon-message-arrow-up-right-regular"})})]}),m>=1024&&s.jsx(q,{date:e==null?void 0:e.createdAt,wrapperClass:"xl:ml-[30px] xl:mr-[75px]"}),s.jsxs("div",{className:"flex gap-4 items-center",children:[s.jsx("button",{className:"icon comment-[18px] mt-0.5 xl:hidden",onClick:()=>c(!0),"aria-label":"See details",children:s.jsx("i",{className:"icon-message-arrow-up-right-regular"})}),s.jsx(Z,{})]})]})}),s.jsx(K,{open:i,onClose:()=>c(!1),children:s.jsxs("div",{className:"card relative no-hover flex flex-col w-full max-w-[400px] will-change-transform",children:[s.jsx("button",{className:"absolute top-5 right-5 icon comment-[18px] transition hover:comment-red",onClick:()=>c(!1),"aria-label":"Close",children:s.jsx("i",{className:"icon-circle-xmark-regular"})}),s.jsx(S,{data:e==null?void 0:e.userId,wrapperClass:"gap-4 mb-5"}),s.jsxs("p",{className:"flex gap-4 mb-2",children:[s.jsx("span",{className:"label-comment",children:"Date: "}),s.jsx("span",{className:"comment-sm font-medium",children:se(e==null?void 0:e.createdAt).format("DD/MM/YYYY, hh:mm A")})]}),s.jsxs("div",{className:"flex gap-4 mb-6",children:[s.jsx("span",{className:"label-comment",children:"Rate:"}),s.jsx(N,{rating:e==null?void 0:e.rating})]}),s.jsx("div",{className:"bg-input-bg rounded-md border border-input-border h-[240px] p-4 overflow-y-auto",children:e==null?void 0:e.comment})]})})]})},me=({reviews:e,options:r,cb_setParamsPage:l,cb_setParamsSort:m})=>{const[t,u]=n.useState(v[0]),o=le({...r,data:e,limit:R});return n.useEffect(()=>{const i={};v.map(c=>{c.value===(t==null?void 0:t.value)&&(i.orderByKey=c.orderByKey??"_id",i.orderByValue=c.orderByValue??-1)}),m&&(m(i),o.setCurrentPage(0))},[t]),n.useEffect(()=>{l&&l({page:+o.currentPage>0?+o.currentPage+1:1})},[o.currentPage]),s.jsxs(h,{className:"flex flex-1 flex-col gap-[26px]",children:[s.jsxs("div",{className:"card !p-0 flex-1",children:[s.jsxs("div",{className:"flex flex-col p-5 gap-2.5 md:flex-row md:justify-between md:items-center md:px-[26px]",children:[s.jsx("h5",{children:"Latest Accepted Reviews"}),s.jsx(X,{value:t,onChange:u,options:v,variant:"minimal"})]}),s.jsx("span",{className:"block h-[1px] bg-input-border opacity-60"}),s.jsx("div",{children:o.currentItems().map((i,c)=>s.jsx(te,{data:i,index:c},`${t}-${i==null?void 0:i._id}`))})]}),o.maxPage>1&&s.jsx(re,{pagination:o})]})},xe=({score:e=0})=>s.jsxs(h,{className:"card flex flex-col items-start md:items-center md:!pt-11",children:[s.jsx(N,{value:e}),s.jsx(ce,{className:"h2 md:!text-[32px] my-[17px]",num:e,decimals:1}),s.jsx("span",{className:"h6",children:"Review score"})]}),Ae=()=>{const{t:e}=G(),r=U(z),[l,m]=n.useState({}),[t,u]=n.useState([]),[o,i]=n.useState([]),[c,C]=n.useState(0),[P,d]=n.useState({page:1,limit:R,orderByValue:-1,orderByKey:"_id",shopId:r==null?void 0:r._id}),{data:g,error:ae,isSuccess:_,isLoading:pe}=H(P,{refetchOnMountOrArgChange:!0,skip:!1});return n.useEffect(()=>{if(_){const{reviews:x,totalCount:a,totalPages:A,limit:E,page:k,count1:T,count2:B,count3:I,count4:$,count5:f}=g==null?void 0:g.metadata,b=(f+f)/a,O=1-b,D={totalCount:a,totalPages:A,limit:E,page:k,Positive:+(b*100).toFixed(0),Negative:+(O*100).toFixed(0)},y=[{rate:5,value:f},{rate:4,value:$},{rate:3,value:I},{rate:2,value:B},{rate:1,value:T}],M=y.reduce((V,p)=>+V+ +(p==null?void 0:p.rate)*+(p==null?void 0:p.value),0);C(+(+M/+a).toFixed(1)),i(y),m(D),u(x)}},[g]),n.useEffect(()=>{d(x=>({...x,shopId:r==null?void 0:r._id}))},[r]),s.jsxs(s.Fragment,{children:[s.jsx(Y,{title:e("Reviews")}),s.jsxs("div",{className:"flex flex-col flex-1 gap-5 md:gap-[26px]",children:[s.jsxs("div",{className:"grid grid-cols-1 gap-y-5 md:gap-y-[26px] xl:grid-cols-6 xl:gap-x-[26px]",children:[s.jsxs("div",{className:"widgets-grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 xl:col-span-4",children:[s.jsx(xe,{score:c}),s.jsx(j,{label:"Total",count:(l==null?void 0:l.totalCount)??0,color:"green"}),s.jsx(j,{label:"Positive",count:(l==null?void 0:l.Positive)??0,suffix:"%",iconClass:"user-plus-solid"}),s.jsx(j,{label:"Negative",count:(l==null?void 0:l.Negative)??0,suffix:"%",color:"red",iconClass:"user-group-crown-solid"})]}),s.jsx(ne,{data:o})]}),s.jsx(me,{reviews:t,options:l,cb_setParamsPage:x=>{d(a=>({...a,...x}))},cb_setParamsSort:x=>{d(a=>({...a,page:1,...x}))}})]})]})};export{Ae as default};
