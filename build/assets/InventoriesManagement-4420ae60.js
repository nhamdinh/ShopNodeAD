import{P as K,j as e,C as z}from"./mui-8cc0f558.js";import{P as H}from"./PageHeader-3e5a35a6.js";import{_ as J,x as W,u as Z,a as X,I as ee,J as se,F as te,C as ae,D as le,K as ne,E as ie,w as re,M as L,O as oe,o as q,h as ce,k as de,p as me,Q as I,R as xe,H as pe}from"./index-d37d0d2e.js";import{C as he}from"./index-526a1bda.js";import{S as y}from"./index-17431800.js";import{T as ge,C as ue,r as o}from"./antd-18c18a77.js";import{E as fe}from"./Empty-d7a235dc.js";import{P as Se}from"./Pagination-2bfb5f72.js";import{S as je}from"./SubmenuTrigger-a96777a5.js";import{u as ye}from"./usePaginationApi-88bb9964.js";import{I as be}from"./columnDefs-25c396cb.js";import{r as _e}from"./commonFunction-fdac5eb3.js";import"./DocumentTitle-53b49d61.js";import"./RatingStars-53409ddf.js";import"./Timestamp-d79ab090.js";import"./Trend-9191d14d.js";import"./Counter-f6fae9cb.js";import"./helpers-8c6e04da.js";const ve=J(ge).withConfig({displayName:"styles__StyledTable",componentId:"sc-vp2vho-0"})(["flex-grow:1;.ant-spin-nested-loading,.ant-spin-container{height:100%;}.ant-spin-container{display:flex;flex-direction:column;}.ant-table{flex-grow:1;background:transparent;}.ant-table-thead .ant-table-cell{background:var(--widget);padding:30px 15px 20px !important;border-bottom:1px solid var(--border) !important;&:first-of-type{padding-left:24px !important;}&:last-of-type{text-align:right;padding-right:24px !important;}}.ant-table-tbody .ant-table-cell{border:none !important;padding:30px 15px !important;&:first-of-type{padding-left:24px !important;}&:last-of-type{padding-right:24px !important;}}"]),G=({product:s,activeCollapse:l,handleCollapse:m})=>{const i=s==null?void 0:s.sku_stock;return e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(ue,{}),e.jsxs("div",{className:"flex items-center gap-2.5",children:[e.jsx("div",{className:"img-wrapper w-[40px] h-[40px] flex items-center justify-center",children:e.jsx("img",{src:(s==null?void 0:s.product_thumb_small)??(s==null?void 0:s.product_thumb),alt:"product"})}),e.jsx("h6",{className:"text-sm max-w-[100px] truncate",children:s==null?void 0:s._id})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{className:`collapse-btn ${l===(s==null?void 0:s._id)?"active":""}`,"aria-label":"Toggle view",onClick:()=>m(s==null?void 0:s._id),children:e.jsx("i",{className:"icon icon-caret-down-solid"})}),e.jsx(je,{})]})]}),e.jsx(z,{in:l===(s==null?void 0:s._id),children:e.jsx("table",{className:"basic-table",children:e.jsxs("tbody",{children:[e.jsx("tr",{children:e.jsx("td",{colSpan:2,children:"Product"})}),e.jsx("tr",{children:e.jsx("td",{colSpan:2,children:e.jsxs("div",{className:"flex gap-2.5",children:[e.jsx("div",{className:"img-wrapper w-[45px] h-[45px] flex items-center justify-center",children:e.jsx("img",{src:(s==null?void 0:s.product_thumb_small)??(s==null?void 0:s.product_thumb),alt:"product"})}),e.jsx("h6",{className:"text-sm max-w-[155px] df items__center ",children:s==null?void 0:s.product_name})]})})}),e.jsx("tr",{children:e.jsxs("td",{colSpan:2,children:["SKU: ",s==null?void 0:s._id]})}),e.jsx("tr",{children:e.jsxs("td",{colSpan:2,children:["Stock status:",i==null?"On Demand":e.jsxs("span",{children:[e.jsx("span",{className:`${i!==0?"text-green":"text-red"}`,children:i!==0?i>=W?"In stock ":"Low Inventory ":"Out of stock "}),"(",i,"/",s==null?void 0:s.product_quantity,")"]})]})}),e.jsx("tr",{children:e.jsxs("td",{colSpan:2,children:["Price: $",s==null?void 0:s.sku_price]})}),e.jsx("tr",{children:e.jsxs("td",{colSpan:2,children:["Sold: ",s==null?void 0:s.sku_sold]})})]})})})]})};G.propTypes={product:K.object.isRequired,activeCollapse:K.string.isRequired,handleCollapse:K.func.isRequired};const Ne=({page_size:s=6,products:l=[],options:m,status:i,userInfo:p,cb_setParamsPage:C,cb_setParamsStatus:O,cb_setParamsFilter:P,cb_onGetProductsByShop:T})=>{const w=Z(),{width:f}=X(),x=oe.filter(t=>t),k={sort:null,productType:null,stockStatus:null,product_categories:null,productSeller:null,brand:null,additionalOptions:null},[b,S]=o.useState([]),[h,A]=o.useState("all"),[a,r]=o.useState(k),[j,_]=o.useState(null),[E,v]=o.useState(""),B=t=>({all:(m==null?void 0:m.countAll)??l.length,publish:(i==null?void 0:i.isPublished)??0,draft:(i==null?void 0:i.isDraft)??0})[t]??0,g=({value:t,label:n},d)=>{r(u=>({...u,[d]:{label:n,value:t}}))},D=()=>{const t=_e({...a}),n={};Object.keys(t).forEach(d=>{d==="sort"&&x.map(u=>{u.value===t[d].value&&(n.orderByKey=u.orderByKey??"_id",n.orderByValue=u.orderByValue??-1)})}),P&&(P(n),S([]),c.setCurrentPage(0))},R=()=>{r(k)},c=ye({...m,data:(()=>h==="all"?l:l.filter(t=>t.status===h))(),limit:s});o.useEffect(()=>{v("")},[f]),o.useEffect(()=>{C&&(S([]),C({page:+c.currentPage>0?+c.currentPage+1:1}))},[c.currentPage]);const F=t=>{v(E===t?"":t)},V=t=>{S(t)},N=b.length===0||!j,U=()=>{var d;const t=(d=L.find(u=>u.value===j.value))==null?void 0:d.bodyUpdate,n={ids:b,bodyUpdate:t,product_shop:p==null?void 0:p._id};Q(n)},[$,{isLoading:Y,error:Ce}]=ee(),Q=async t=>{await $(t).then(n=>{const d=n==null?void 0:n.data;d!=null&&d.metadata?(T&&T(),S([]),w(q({isOpen:Date.now(),content:"Updated Success",step:1}))):w(q({isOpen:Date.now(),content:"Update Failed",step:2}))}).catch(n=>{console.log(n)})};return e.jsxs("div",{className:"flex flex-col flex-1",children:[e.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[e.jsx("span",{className:"text-header",children:"Products:"}),e.jsx("div",{children:se.map((t,n)=>e.jsx(te,{text:t.label,qty:B(t.value),value:t.value,active:h,onClick:()=>{O&&(S([]),O(t.value)),A(t.value),c.setCurrentPage(0)}},`filter-${n}`))})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-3 md:gap-x-6 xl:grid-cols-6",children:[e.jsx(y,{options:x,value:a.sort,placeholder:"Sort",onChange:t=>g(t,"sort")}),e.jsx(y,{options:ae,value:a.stockStatus,placeholder:"Stock Status",onChange:t=>g(t,"stockStatus")}),e.jsx(y,{options:le,value:a.productSeller,placeholder:"Product Seller",onChange:t=>g(t,"productSeller")}),e.jsx(y,{options:ne,value:a.productType,placeholder:"Product Type",onChange:t=>g(t,"productType")}),e.jsx(y,{options:ie,value:a.additionalOptions,placeholder:"Additional Options",onChange:t=>g(t,"additionalOptions")}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{className:"btn btn--secondary !gap-[5px]",onClick:D,children:["Apply ",e.jsx("i",{className:"icon-chevron-right-regular text-sm"})]}),e.jsx("button",{className:"btn btn--outline blue !h-[44px]",onClick:R,children:"Clear"})]})]}),e.jsxs("div",{className:"flex flex-col-reverse gap-4 mt-4 mb-5 md:flex-row md:justify-between md:items-end md:mt-5 md:mb-6",children:[e.jsxs("p",{children:["View products: ",c.showingOf()]}),e.jsx("div",{children:e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{disabled:N,className:"btn btn--outline red !gap-[5px]",onClick:U,children:[Y?e.jsx(re,{radius:30}):"Apply Action",e.jsx("i",{className:"icon-chevron-right-regular text-sm"})]}),e.jsx("div",{className:"md:min-w-[280px]",children:e.jsx(y,{options:L,value:j,placeholder:"Select Action",onChange:t=>{_(t)}})})]})})]}),e.jsxs("div",{className:"flex flex-1 flex-col gap-[22px]",children:[f>=768?e.jsx(ve,{columns:be,dataSource:c.currentItems(),rowKey:t=>t._id,locale:{emptyText:e.jsx(fe,{text:"No products found"})},rowSelection:{type:"checkbox",selectedRowKeys:b,onChange:V},pagination:!1}):e.jsx("div",{className:"flex flex-col gap-5",children:c.currentItems().map((t,n)=>e.jsx(G,{product:t,handleCollapse:F,activeCollapse:E},`product-${n}`))}),c.maxPage>1&&e.jsx(Se,{pagination:c})]})]})},Ge=()=>{const{t:s}=ce(),l=de(me),[m,i]=o.useState(""),[p,C]=o.useState([]);p.map(a=>({...a.sku_product_id,...a}));const[O,P]=o.useState({}),[T,w]=o.useState({}),[f,x]=o.useState({shopId:l==null?void 0:l._id,limit:I,page:1,orderByKey:"_id",orderByValue:-1}),[k,{isLoading:b,error:S}]=xe(),h=async()=>{const a=await k(f),r=a==null?void 0:a.data;if(r){const{countAll:j,totalCount:_,totalPages:E,limit:v,page:B,isDelete:g,isPublished:D,isDraft:R,skus:M}=r==null?void 0:r.metadata,c=M,F={countAll:j,totalCount:_,totalPages:E,limit:v,page:B};w({isDelete:g,isPublished:D,isDraft:R}),P(F),C(c.map(N=>{const U=N.isDelete?"trash":N.isPublished?"publish":"draft";return{...N,status:U}}))}};o.useEffect(()=>{f.shopId&&h()},[f]),o.useEffect(()=>{x({shopId:l==null?void 0:l._id,limit:I,page:1,orderByKey:"_id",orderByValue:-1})},[l]);const A=p.map(a=>Object.entries(a).map(([j,_])=>_));return e.jsxs(e.Fragment,{children:[e.jsx(H,{isFetching:b,cb_refetch:h,title:s("Inventories Management")}),e.jsxs("div",{className:"flex flex-col-reverse gap-4 mb-5 md:flex-col lg:flex-row lg:justify-between",children:[e.jsx("div",{className:"flex flex-col gap-4 md:flex-row md:gap-[14px]",children:e.jsxs(he,{className:"btn btn--outline blue !h-[44px]",data:A,children:["Export CSV ",e.jsx("i",{className:"icon-file-export-solid"})]})}),e.jsx(pe,{query:m,setQuery:i,cb_setParamsSearch:()=>{x(a=>({...a,page:1,keyword:m}))},wrapperClass:"lg:w-[326px]",placeholder:"Search Product"})]}),e.jsx(Ne,{cb_onGetProductsByShop:h,cb_setParamsPage:a=>{x(r=>({...r,...a}))},cb_setParamsStatus:a=>{const r={all:{},publish:{isDelete:!1,isPublished:!0},draft:{isDelete:!1,isPublished:!1}};x({shopId:l==null?void 0:l._id,limit:I,page:1,orderByKey:"_id",orderByValue:-1,...r[a]})},cb_setParamsFilter:a=>{x(r=>({...r,page:1,...a}))},products:p.map(a=>({...a.sku_product_id,...a})),options:O,status:T,userInfo:l,page_size:I})]})};export{Ge as default};
