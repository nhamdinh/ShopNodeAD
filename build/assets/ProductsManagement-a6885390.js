import{P as I,j as e,C as Y}from"./mui-8cc0f558.js";import{P as ee}from"./PageHeader-3e5a35a6.js";import{_ as se,x as te,u as ae,a as le,k as z,n as ne,v as ie,y as D,z as re,B as ce,F as oe,C as de,D as me,E as xe,w as pe,G as K,o as $,h as he,p as ge,r as ue,H as fe}from"./index-d37d0d2e.js";import{C as je}from"./index-526a1bda.js";import{S as j}from"./index-17431800.js";import{T as Se,C as be,r as i}from"./antd-18c18a77.js";import{E as _e}from"./Empty-d7a235dc.js";import{P as ve}from"./Pagination-2bfb5f72.js";import{S as ye}from"./SubmenuTrigger-a96777a5.js";import{u as Pe}from"./usePaginationApi-88bb9964.js";import{P as Ne}from"./columnDefs-25c396cb.js";import{r as Ce}from"./commonFunction-fdac5eb3.js";import"./DocumentTitle-53b49d61.js";import"./RatingStars-53409ddf.js";import"./Timestamp-d79ab090.js";import"./Trend-9191d14d.js";import"./Counter-f6fae9cb.js";import"./helpers-8c6e04da.js";const we=se(Se).withConfig({displayName:"styles__StyledTable",componentId:"sc-k8b1p0-0"})(["flex-grow:1;.ant-spin-nested-loading,.ant-spin-container{height:100%;}.ant-spin-container{display:flex;flex-direction:column;}.ant-table{flex-grow:1;background:transparent;}.ant-table-thead .ant-table-cell{background:var(--widget);padding:30px 15px 20px !important;border-bottom:1px solid var(--border) !important;&:first-of-type{padding-left:24px !important;}&:last-of-type{text-align:right;padding-right:24px !important;}}.ant-table-tbody .ant-table-cell{border:none !important;padding:30px 15px !important;&:first-of-type{padding-left:24px !important;}&:last-of-type{padding-right:24px !important;}}"]),Q=({product:s,activeCollapse:a,handleCollapse:o})=>{var x;const m=s==null?void 0:s.product_quantity;return e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(be,{}),e.jsxs("div",{className:"flex items-center gap-2.5",children:[e.jsx("div",{className:"img-wrapper w-[40px] h-[40px] flex items-center justify-center",children:e.jsx("img",{src:(s==null?void 0:s.product_thumb_small)??(s==null?void 0:s.product_thumb),alt:"product"})}),e.jsx("h6",{className:"text-sm max-w-[100px] truncate",children:s==null?void 0:s._id})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{className:`collapse-btn ${a===(s==null?void 0:s._id)?"active":""}`,"aria-label":"Toggle view",onClick:()=>o(s==null?void 0:s._id),children:e.jsx("i",{className:"icon icon-caret-down-solid"})}),e.jsx(ye,{})]})]}),e.jsx(Y,{in:a===(s==null?void 0:s._id),children:e.jsx("table",{className:"basic-table",children:e.jsxs("tbody",{children:[e.jsx("tr",{children:e.jsx("td",{colSpan:2,children:"Product"})}),e.jsx("tr",{children:e.jsx("td",{colSpan:2,children:e.jsxs("div",{className:"flex gap-2.5",children:[e.jsx("div",{className:"img-wrapper w-[45px] h-[45px] flex items-center justify-center",children:e.jsx("img",{src:(s==null?void 0:s.product_thumb_small)??(s==null?void 0:s.product_thumb),alt:"product"})}),e.jsx("h6",{className:"text-sm max-w-[155px] df items__center",children:s==null?void 0:s.product_name})]})})}),e.jsx("tr",{children:e.jsxs("td",{colSpan:2,children:["SKU: ",s==null?void 0:s._id]})}),e.jsx("tr",{children:e.jsxs("td",{colSpan:2,children:["Stock status:",m==null?"On Demand":e.jsxs("span",{children:[e.jsx("span",{className:`${m!==0?"text-green":"text-red"}`,children:m!==0?m>=te?"In stock ":"Low Inventory ":"Out of stock "}),"(",m,")"]})]})}),e.jsx("tr",{children:e.jsxs("td",{colSpan:2,children:["Price: $",s==null?void 0:s.product_price]})}),e.jsx("tr",{children:e.jsxs("td",{colSpan:2,children:["Brand:",e.jsx("button",{className:"capitalize text-accent ml-1",children:(x=s==null?void 0:s.product_brand)==null?void 0:x.brand})]})})]})})})]})};Q.propTypes={product:I.object.isRequired,activeCollapse:I.string.isRequired,handleCollapse:I.func.isRequired};const Oe=({products:s=[],options:a,status:o,userInfo:m,cb_setParamsPage:x,cb_setParamsStatus:P,cb_setParamsFilter:N,cb_onGetProductsByShop:C})=>{const w=ae(),{width:O}=le(),S=z(ne),p={stockStatus:null,product_categories:null,productSeller:null,brand:null,additionalOptions:null},[b,g]=i.useState([]),[T,_]=i.useState("all"),[h,r]=i.useState(p),[l,v]=i.useState(null),[f,y]=i.useState(""),k=t=>({all:(a==null?void 0:a.countAll)??s.length,trash:(o==null?void 0:o.isDelete)??0,publish:(o==null?void 0:o.isPublished)??0,draft:(o==null?void 0:o.isDraft)??0})[t]??0,u=({value:t,label:n},c)=>{r(M=>({...M,[c]:{label:n,value:t}}))},F=()=>{const t=Ce({...h}),n={};Object.keys(t).forEach(c=>{c==="product_categories"&&(n[c]=t[c].value),c==="brand"&&(n[c]=t[c].value)}),console.log(n),N&&(N(n),g([]),d.setCurrentPage(0))},[U,{isLoading:B,error:G}]=ie(),R=async t=>{const n=await U(t),c=n==null?void 0:n.data;c!=null&&c.metadata?(C&&C(),g([]),w($({isOpen:Date.now(),content:"Updated Success",step:1}))):w($({isOpen:Date.now(),content:"Update Failed",step:2}))},L=()=>{var c;const t=(c=K.find(M=>M.value===l.value))==null?void 0:c.bodyUpdate,n={ids:b,bodyUpdate:t,product_shop:m==null?void 0:m._id};R(n)},q=()=>{r(p)},d=Pe({...a,data:(()=>T==="all"?s:s.filter(t=>t.status===T))(),limit:D});i.useEffect(()=>{y("")},[O]),i.useEffect(()=>{x&&(g([]),x({page:+d.currentPage>0?+d.currentPage+1:1}))},[d.currentPage]);const V=t=>{y(f===t?"":t)},H=t=>{g(t)};i.useState("All");const[W,Z]=i.useState([]),{data:E,error:Te,isSuccess:J,isLoading:Ae}=re({page:1,limit:1e3},{refetchOnMountOrArgChange:!0,skip:!1});i.useEffect(()=>{J&&Z(E==null?void 0:E.brands.map(t=>({value:t._id,label:t.brand})))},[E]);const X=b.length===0||!l;return e.jsxs("div",{className:"flex flex-col flex-1",children:[e.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[e.jsx("span",{className:"text-header",children:"Products:"}),e.jsx("div",{children:ce.map((t,n)=>e.jsx(oe,{text:t.label,qty:k(t.value),value:t.value,active:T,onClick:()=>{console.log(t.value),P&&(g([]),P(t.value)),_(t.value),d.setCurrentPage(0)}},`filter-${n}`))})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-3 md:gap-x-6 xl:grid-cols-6",children:[e.jsx(j,{options:de,value:h.stockStatus,placeholder:"Stock Status",onChange:t=>u(t,"stockStatus")}),e.jsx(j,{options:S,value:h.product_categories,placeholder:"Product Category",onChange:t=>u(t,"product_categories")}),e.jsx(j,{options:me,value:h.productSeller,placeholder:"Product Seller",onChange:t=>u(t,"productSeller")}),e.jsx(j,{options:W,value:h.brand,placeholder:"Product Brands",onChange:t=>u(t,"brand")}),e.jsx(j,{options:xe,value:h.additionalOptions,placeholder:"Additional Options",onChange:t=>u(t,"additionalOptions")}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{className:"btn btn--secondary !gap-[5px]",onClick:F,children:["Apply ",e.jsx("i",{className:"icon-chevron-right-regular text-sm"})]}),e.jsx("button",{className:"btn btn--outline blue !h-[44px]",onClick:q,children:"Clear"})]})]}),e.jsxs("div",{className:"flex flex-col-reverse gap-4 mt-4 mb-5 md:flex-row md:justify-between md:items-end md:mt-5 md:mb-6",children:[e.jsxs("p",{children:["View products: ",d.showingOf()]}),e.jsx("div",{children:e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{disabled:X,className:"btn btn--outline red !gap-[5px]",onClick:L,children:[B?e.jsx(pe,{radius:30}):"Apply Action",e.jsx("i",{className:"icon-chevron-right-regular text-sm"})]}),e.jsx("div",{className:"md:min-w-[280px]",children:e.jsx(j,{options:K,value:l,placeholder:"Select Action",onChange:t=>{v(t)}})})]})})]}),e.jsxs("div",{className:"flex flex-1 flex-col gap-[22px]",children:[O>=768?e.jsx(we,{columns:Ne,dataSource:d.currentItems(),rowKey:t=>t._id,locale:{emptyText:e.jsx(_e,{text:"No products found"})},rowSelection:{type:"checkbox",selectedRowKeys:b,onChange:H},pagination:!1}):e.jsx("div",{className:"flex flex-col gap-5",children:d.currentItems().map((t,n)=>e.jsx(Q,{product:t,handleCollapse:V,activeCollapse:f},`product-${n}`))}),d.maxPage>1&&e.jsx(ve,{pagination:d})]})]})},We=()=>{const{t:s}=he(),a=z(ge),[o,m]=i.useState(""),[x,P]=i.useState([]),[N,C]=i.useState({}),[w,O]=i.useState({}),[S,p]=i.useState({product_shop:a==null?void 0:a._id,limit:D,page:1}),[b,{isLoading:g,error:T}]=ue(),_=async()=>{var v;const r=await b(S),l=r==null?void 0:r.data;if(l){const{countAll:f,totalCount:y,totalPages:k,limit:u,page:F,isDelete:U,isPublished:B,isDraft:G}=l==null?void 0:l.metadata,R=(v=l==null?void 0:l.metadata)==null?void 0:v.products,L={countAll:f,totalCount:y,totalPages:k,limit:u,page:F};O({isDelete:U,isPublished:B,isDraft:G}),C(L),P(R.map(A=>{const d=A.isDelete?"trash":A.isPublished?"publish":"draft";return{...A,status:d}}))}};i.useEffect(()=>{S.product_shop&&_()},[S]),i.useEffect(()=>{p({product_shop:a==null?void 0:a._id,limit:D,page:1})},[a]);const h=x.map(r=>Object.entries(r).map(([v,f])=>f));return e.jsxs(e.Fragment,{children:[e.jsx(ee,{isFetching:g,cb_refetch:_,title:s("Products Management")}),e.jsxs("div",{className:"flex flex-col-reverse gap-4 mb-5 md:flex-col lg:flex-row lg:justify-between",children:[e.jsx("div",{className:"flex flex-col gap-4 md:flex-row md:gap-[14px]",children:e.jsxs(je,{className:"btn btn--outline blue !h-[44px]",data:h,children:["Export CSV ",e.jsx("i",{className:"icon-file-export-solid"})]})}),e.jsx(fe,{query:o,setQuery:m,cb_setParamsSearch:()=>{p(r=>({...r,page:1,keyword:o}))},wrapperClass:"lg:w-[326px]",placeholder:"Search Product"})]}),e.jsx(Oe,{cb_onGetProductsByShop:_,cb_setParamsPage:r=>{p(l=>({...l,...r}))},cb_setParamsStatus:r=>{const l={all:{},trash:{isDelete:!0},publish:{isDelete:!1,isPublished:!0},draft:{isDelete:!1,isPublished:!1}};p({product_shop:a==null?void 0:a._id,limit:D,page:1,...l[r]})},cb_setParamsFilter:r=>{p(l=>({...l,page:1,...r}))},products:x,options:N,status:w,userInfo:a})]})};export{We as default};
