import{j as e,P as u,C as pe}from"./mui-2493782d.js";import{T as xe,r as i,l as F}from"./antd-1d728b6a.js";import{P as me}from"./PageHeader-8dc226f4.js";import{C as ue}from"./CalendarSelector-8c963a0e.js";import{S as K}from"./index-8d8d8ff4.js";import{S as I,_ as ge,a as B,g as G,j as z,m as he,O as L,n as je,p as A,M as fe,R as S}from"./index-f5793006.js";import{L as M}from"./LabeledProgressBar-d4425967.js";import{C as _e}from"./Counter-934451c1.js";import{S as D}from"./SubmenuTrigger-34b58daa.js";import{P as be}from"./Pagination-94a491c8.js";import{R as V}from"./RatingStars-632e9c20.js";import{d as Z}from"./helpers-22670235.js";import{E as ve}from"./Empty-0bb19490.js";import{u as Ne}from"./usePagination-6afed751.js";import{f as ye}from"./commonFunction-f8b3aaf0.js";import"./DocumentTitle-62345d26.js";import"./index-cc8501c9.js";import"./ProgressBar-f24a8929.js";var g=256,H=[],q=256,P;for(;g--;)H[g]=(g+256).toString(16).substring(1);function Se(t){var r=0,c=t||11;if(!P||g+c>q*2)for(P="",g=0;r<q;r++)P+=H[Math.random()*256|0];return P.substring(g,g+++c)}const Pe=()=>e.jsxs(I,{className:"card flex flex-col gap-4",children:[e.jsx("h5",{children:"Average Rate (%)"}),e.jsxs("div",{className:"flex flex-col gap-2.5",children:[e.jsx(M,{color:"header",label:"Product Views",value:87,displayValue:"87%"}),e.jsx(M,{color:"header",label:"Cart Abandonment Rate",value:23,displayValue:"23%"})]})]}),f=({icon:t,color:r="accent",title:c="Lorem ipsum",count:n=0})=>e.jsxs(I,{className:"card !pb-5",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("div",{className:"badge-icon badge-icon--sm",style:{backgroundColor:`var(--${r})`},children:t}),e.jsx(D,{})]}),e.jsxs("h6",{className:"mt-[28px] mb-2.5",children:[e.jsx("span",{className:"xl:hidden 2xl:inline",children:"Orders "}),c]}),e.jsx(_e,{className:"h3",num:n})]});f.propTypes={icon:u.node,color:u.oneOf(["accent","green","red","badge-status-bg"]),title:u.string,count:u.number};const we=ge(xe).withConfig({displayName:"styles__StyledTable",componentId:"sc-gvbfgj-0"})(["margin-bottom:30px;flex-grow:1;.ant-table{padding:0 26px;}.ant-table-thead .ant-table-cell{padding:33px 0 28px !important;background:var(--widget);&:last-child{text-align:right;}}.ant-table-row:last-child .ant-table-cell{border-bottom:0;}.ant-table-row .ant-table-cell{padding:32px 0;}.ant-table-cell{border-color:var(--input-border) !important;}@media (min-width:1536px){.product-cell{width:23%;}}"]),X=({order:t,activeCollapse:r,handleCollapse:c})=>{const n=B().width<375,o=t.payment.totalAmountPay===t.payment.received?"Fully paid":t.payment.totalAmountPay>t.payment.received&&t.payment.received!==0?"Partially paid":"Unpaid";return e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"subheading-2",children:["#",t._id]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{className:`collapse-btn ${r===t.SKU?"active":""}`,"aria-label":"Toggle view",onClick:()=>c(t.SKU),children:e.jsx("i",{className:"icon icon-caret-down-solid"})}),e.jsx(G,{to:"/product-editor","aria-label":"Edit",children:e.jsx("i",{className:"icon icon-pen-to-square-regular"})}),e.jsx(D,{})]})]}),e.jsx(pe,{in:r===t.SKU,children:e.jsx("table",{className:"basic-table",children:e.jsxs("tbody",{children:[e.jsx("tr",{children:e.jsx("td",{colSpan:2,children:"Product"})}),e.jsx("tr",{children:e.jsx("td",{colSpan:2,children:e.jsxs("div",{className:"flex gap-6",children:[e.jsx("div",{className:"img-wrapper w-[70px] h-[64px] flex items-center justify-center",children:e.jsx("img",{src:t.product.product_thumb_small??t.product.product_thumb,alt:t.product.name})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h5",{className:"text-sm mb-1.5",children:t.product.name}),e.jsxs("div",{className:"flex flex-col gap-1 text-sm text-body-text",children:[e.jsxs("p",{children:["Regular price: $",t.product.product_price]}),t.product.product_original_price&&e.jsxs("p",{children:["Sale price: $",t.product.product_original_price]})]})]})]})})}),e.jsxs("tr",{children:[e.jsx("td",{children:"SKU"}),e.jsx("td",{children:t.SKU})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"Category"}),e.jsx("td",{className:"capitalize",children:t.product_type})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"Payment"}),e.jsx("td",{children:e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("span",{className:"font-heading font-bold text-header",children:[o!=="Fully paid"&&`$${t.payment.received} / from `,"$",t.payment.totalAmountPay]}),e.jsx("span",{children:o})]})})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"Status"}),e.jsx("td",{className:"capitalize",children:n?t.status:e.jsx("span",{className:"badge-status badge-status--lg",style:{backgroundColor:`var(--${Z(t.status)})`,width:"100%"},children:t.status})})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"Rate"}),e.jsx("td",{children:n?t.product_ratings:e.jsx("div",{className:"flex justify-center",children:e.jsx(V,{rating:t.product_ratings})})})]})]})})})]})};X.propTypes={order:u.object.isRequired,activeCollapse:u.string.isRequired,handleCollapse:u.func.isRequired};const Ce=({category:t,sort:r,ordersProduct:c,categories:n})=>{const{width:o}=B(),[_,l]=i.useState(""),x=t.value==="all"?c:c.filter(s=>s.product_categories.includes(t.value)),p=Ne({data:(()=>{switch(r.value){default:case"default":return x;case"a-z":return x.sort((s,a)=>s.product.product_name.localeCompare(a.product.product_name));case"z-a":return x.sort((s,a)=>a.product.product_name.localeCompare(s.product.product_name));case"rating-high-to-low":return x.sort((s,a)=>a.product_ratings-s.product_ratings);case"rating-low-to-high":return x.sort((s,a)=>s.product_ratings-a.product_ratings)}})(),limit:5});i.useEffect(()=>{p.goToPage(0),l("")},[t,r]),i.useEffect(()=>{l("")},[p.currentPage,o]);const w=s=>{l(_===s?"":s)},b=s=>n.find(a=>a.value===s),C=[{title:"# order",dataIndex:"_id",width:"100px",render:s=>e.jsxs("div",{className:"subheading-2 w80px line__clamp__2",children:["#",s]})},{title:"Product",dataIndex:"product",className:"product-cell",render:s=>e.jsxs("div",{className:"flex gap-6",children:[e.jsx("div",{className:"img-wrapper w-[70px] h-[64px] flex items-center justify-center shrink-0",children:e.jsx("img",{src:(s==null?void 0:s.product_thumb_small)??(s==null?void 0:s.product_thumb),alt:s.product_name})}),e.jsxs("div",{className:"flex-col hidden 2xl:flex",children:[e.jsx("h5",{className:"text-sm max-w-[195px] mb-1.5 line__clamp__2",children:s.product_name}),e.jsxs("div",{className:"flex flex-col gap-1 text-sm",children:[e.jsxs("p",{children:["Regular price: $",s.product_price]}),s.product_original_price&&e.jsxs("p",{children:["Sale price: $",s.product_original_price]})]})]})]}),responsive:["lg"]},{title:"SKU",dataIndex:"product_id",render:s=>e.jsx("div",{className:"w80px line__clamp__2",children:s})},{title:"Category",dataIndex:"product_categories",render:s=>e.jsx("div",{className:"flex items-center gap-4 direction__column",children:s.map(a=>{var v,N,y;return e.jsxs("div",{className:"flex items-center gap-4 ",children:[e.jsx("div",{className:`badge-icon badge-icon--sm bg-${(v=b(a))==null?void 0:v.color}`,children:e.jsx("i",{className:`${(N=b(a))==null?void 0:N.icon} text-base`})}),e.jsx("span",{className:"label-text capitalize",children:(y=b(a))==null?void 0:y.label})]})})}),responsive:["lg"]},{title:"Payment",dataIndex:"payment",render:s=>{const a=s.totalAmountPay===s.received?"Fully paid":s.totalAmountPay>s.received&&s.received!==0?"Partially paid":"Unpaid";return e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("span",{className:"font-heading font-bold text-header",children:[a!=="Fully paid"&&`$${s.received} / from `,"$",ye(s.totalAmountPay)]}),e.jsx("span",{children:a})]})}},{title:"Order Status",dataIndex:"status",render:s=>e.jsx("span",{className:"badge-status badge-status--lg",style:{backgroundColor:`var(--${Z(s)})`},children:s})},{title:"Rate",dataIndex:"product_ratings",render:s=>e.jsx(V,{rating:s}),responsive:["xl"]},{title:"Actions",dataIndex:"actions",width:"70px",render:()=>e.jsxs("div",{className:"flex items-center justify-end gap-11",children:[e.jsx(G,{to:"/product-editor","aria-label":"Edit",children:e.jsx("i",{className:"icon icon-pen-to-square-regular text-lg leading-none"})}),e.jsx(D,{})]})}];return e.jsxs(I,{className:"flex flex-col flex-1 w-full",children:[o>=768?e.jsx(we,{columns:C,dataSource:p.currentItems(),pagination:!1,locale:{emptyText:e.jsx(ve,{text:"No orders found"})},rowKey:s=>s.SKU}):e.jsx("div",{className:"flex flex-1 flex-col gap-5 mb-[26px]",children:p.currentItems().map(s=>e.jsx(X,{order:s,activeCollapse:_,handleCollapse:w},s.SKU))}),p.maxPage>1&&e.jsx(be,{pagination:p})]})},Ze=()=>{const t=z(he),r=[{value:"all",label:"All Products"},...t],[c,n]=i.useState(r[0]),[o,_]=i.useState(L[0]),l=z(je),[x,$]=i.useState(0),[p,w]=i.useState(0),[b,C]=i.useState(0),[s,a]=i.useState(0),[v,N]=i.useState(0),[y,W]=i.useState([]),[R,T]=i.useState({shopId:l==null?void 0:l._id,limit:A,page:1});i.useEffect(()=>{T({shopId:l==null?void 0:l._id,limit:A,page:1})},[l]);const[J,{isLoading:Q,error:Re}]=fe(),U=async()=>{const h=await J(R),j=h==null?void 0:h.data;if(j){const{isPaid:Y,isDelivered:ee,isCanceled:se,isRefunded:te,isNotPaid:ae,orders:k}=j==null?void 0:j.metadata;$(Y),w(ee),C(se),a(te),N(ae);const le=k.flatMap(d=>d.itemProducts),ie=({isPaid:d,isDelivered:E,isCanceled:m,isRefunded:O})=>O===!0?"refunded":m===!0?"cancelled":E===!0?"confirmed":"completed",re=le.map((d,E)=>{const m=k.find(oe=>oe._id===d.order_id),{isPaid:O,isDelivered:ce,isCanceled:de,isRefunded:ne}=m;return{...m,product_id:d._id,product_ratings:d.product_ratings,product_type:d.product_type,product_categories:d.product_categories,payment:{totalAmountPay:m.totalAmountPay,received:m.isPaid?m.totalAmountPay:0},status:ie({isPaid:O,isDelivered:ce,isCanceled:de,isRefunded:ne}),SKU:Se()+E,product:d}});W(re)}};return i.useEffect(()=>{R.shopId&&U()},[R]),e.jsxs(e.Fragment,{children:[e.jsx(me,{title:"Orders",isFetching:Q,cb_refetch:U}),e.jsxs("div",{className:"flex flex-col flex-1 gap-5 md:gap-[26px]",children:[e.jsxs("div",{className:`w-full grid grid-cols-1 gap-4 md:grid-cols-2 md:gap-[26px] lg:grid-cols-4 lg:items-end
                     xl:grid-cols-6`,children:[e.jsx(ue,{wrapperClass:"lg:max-w-[275px] lg:col-span-2 xl:col-span-4",id:"ordersPeriodSelector",cb_setRangeDate:h=>{const j={gte:F(h[0]).format(),lt:F(h[1]).format()};T({shopId:l==null?void 0:l._id,limit:A,page:1,createdAt:j})}}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 md:gap-[26px] md:col-span-2",children:[e.jsx(K,{value:c,options:r,onChange:n,placeholder:"Product category"}),e.jsx(K,{value:o,options:L,onChange:_,placeholder:"Default sorting"})]})]}),e.jsxs("div",{className:"w-full widgets-grid grid-cols-1 xl:grid-cols-6",children:[e.jsx("div",{className:"xl:col-span-2",children:e.jsx(Pe,{})}),e.jsxs("div",{className:"widgets-grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 xl:col-span-4",children:[e.jsx(f,{title:"Not Paid",count:v*S,color:"red",icon:e.jsx("i",{className:"icon-ban-solid"})}),e.jsx(f,{title:"Paid",count:x*S,icon:e.jsx("i",{className:"icon-check-to-slot-solid"})}),e.jsx(f,{title:"Delivered",count:p*S,color:"green",icon:e.jsx("i",{className:"icon-list-check-solid"})}),e.jsx(f,{title:"Refunded",count:s*S,color:"badge-status-bg",icon:e.jsx("i",{className:"icon-rotate-left-solid"})})]})]}),e.jsx(Ce,{ordersProduct:y,category:c,sort:o,categories:t})]})]})};export{Ze as default};
