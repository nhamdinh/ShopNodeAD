import{j as e,P as u,C as te}from"./mui-2493782d.js";import{T as ae,r as l,l as O}from"./antd-1d728b6a.js";import{P as le}from"./PageHeader-f589027d.js";import{C as ie}from"./CalendarSelector-3c66d657.js";import{S as D}from"./index-d2873610.js";import{S as C,_ as re,a as K,g as ce,G as T,O as A,i as de,n as ne,p as P,K as oe,M as b}from"./index-88527f4e.js";import{L as U}from"./LabeledProgressBar-97305800.js";import{C as pe}from"./Counter-48b40dab.js";import{S as k}from"./SubmenuTrigger-34b58daa.js";import{P as me}from"./Pagination-94a491c8.js";import{R as ue}from"./RatingStars-e1771c4e.js";import{d as xe}from"./helpers-dbcd4939.js";import{E as ge}from"./Empty-34f26085.js";import{u as he}from"./usePagination-6afed751.js";import{O as fe}from"./columnDefs-c86d613d.js";import"./DocumentTitle-62345d26.js";import"./index-d397b3ed.js";import"./ProgressBar-861aaff6.js";import"./Timestamp-eb25fa85.js";import"./Trend-1bb25368.js";var x=256,$=[],I=256,v;for(;x--;)$[x]=(x+256).toString(16).substring(1);function je(s){var i=0,r=s||11;if(!v||x+r>I*2)for(v="",x=0;i<I;i++)v+=$[Math.random()*256|0];return v.substring(x,x+++r)}const be=()=>e.jsxs(C,{className:"card flex flex-col gap-4",children:[e.jsx("h5",{children:"Average Rate (%)"}),e.jsxs("div",{className:"flex flex-col gap-2.5",children:[e.jsx(U,{color:"header",label:"Product Views",value:87,displayValue:"87%"}),e.jsx(U,{color:"header",label:"Cart Abandonment Rate",value:23,displayValue:"23%"})]})]}),j=({icon:s,color:i="accent",title:r="Lorem ipsum",count:c=0})=>e.jsxs(C,{className:"card !pb-5",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("div",{className:"badge-icon badge-icon--sm",style:{backgroundColor:`var(--${i})`},children:s}),e.jsx(k,{})]}),e.jsxs("h6",{className:"mt-[28px] mb-2.5",children:[e.jsx("span",{className:"xl:hidden 2xl:inline",children:"Orders "}),r]}),e.jsx(pe,{className:"h3",num:c})]});j.propTypes={icon:u.node,color:u.oneOf(["accent","green","red","badge-status-bg"]),title:u.string,count:u.number};const ve=re(ae).withConfig({displayName:"styles__StyledTable",componentId:"sc-gvbfgj-0"})(["margin-bottom:30px;flex-grow:1;.ant-table{padding:0 26px;}.ant-table-thead .ant-table-cell{padding:33px 0 28px !important;background:var(--widget);&:last-child{text-align:right;}}.ant-table-row:last-child .ant-table-cell{border-bottom:0;}.ant-table-row .ant-table-cell{padding:32px 0;}.ant-table-cell{border-color:var(--input-border) !important;}@media (min-width:1536px){.product-cell{width:23%;}}"]),F=({order:s,activeCollapse:i,handleCollapse:r})=>{const c=K().width<375,a=s.payment.totalAmountPay===s.payment.received?"Fully paid":s.payment.totalAmountPay>s.payment.received&&s.payment.received!==0?"Partially paid":"Unpaid";return e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"subheading-2",children:["#",s._id]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{className:`collapse-btn ${i===s.SKU?"active":""}`,"aria-label":"Toggle view",onClick:()=>r(s.SKU),children:e.jsx("i",{className:"icon icon-caret-down-solid"})}),e.jsx(ce,{to:"/product-editor","aria-label":"Edit",children:e.jsx("i",{className:"icon icon-pen-to-square-regular"})}),e.jsx(k,{})]})]}),e.jsx(te,{in:i===s.SKU,children:e.jsx("table",{className:"basic-table",children:e.jsxs("tbody",{children:[e.jsx("tr",{children:e.jsx("td",{colSpan:2,children:"Product"})}),e.jsx("tr",{children:e.jsx("td",{colSpan:2,children:e.jsxs("div",{className:"flex gap-6",children:[e.jsx("div",{className:"img-wrapper w-[70px] h-[64px] flex items-center justify-center",children:e.jsx("img",{src:s.product.product_thumb_small??s.product.product_thumb,alt:s.product.name})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h5",{className:"text-sm mb-1.5",children:s.product.name}),e.jsxs("div",{className:"flex flex-col gap-1 text-sm text-body-text",children:[e.jsxs("p",{children:["Regular price: $",s.product.product_price]}),s.product.product_original_price&&e.jsxs("p",{children:["Sale price: $",s.product.product_original_price]})]})]})]})})}),e.jsxs("tr",{children:[e.jsx("td",{children:"SKU"}),e.jsx("td",{children:s.SKU})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"Category"}),e.jsx("td",{className:"capitalize",children:s.product_type})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"Payment"}),e.jsx("td",{children:e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("span",{className:"font-heading font-bold text-header",children:[a!=="Fully paid"&&`$${s.payment.received} / from `,"$",s.payment.totalAmountPay]}),e.jsx("span",{children:a})]})})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"Status"}),e.jsx("td",{className:"capitalize",children:c?s.status:e.jsx("span",{className:"badge-status badge-status--lg",style:{backgroundColor:`var(--${xe(s.status)})`,width:"100%"},children:s.status})})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"Rate"}),e.jsx("td",{children:c?s.product_ratings:e.jsx("div",{className:"flex justify-center",children:e.jsx(ue,{rating:s.product_ratings})})})]})]})})})]})};F.propTypes={order:u.object.isRequired,activeCollapse:u.string.isRequired,handleCollapse:u.func.isRequired};const ye=({category:s,sort:i,ordersProduct:r})=>{const{width:c}=K(),[a,g]=l.useState(""),p=s.value==="all"?r:r.filter(t=>t.product_type===s.value),o=he({data:(()=>{switch(i.value){default:case"default":return p;case"a-z":return p.sort((t,d)=>t.product.product_name.localeCompare(d.product.product_name));case"z-a":return p.sort((t,d)=>d.product.product_name.localeCompare(t.product.product_name));case"rating-high-to-low":return p.sort((t,d)=>d.product_ratings-t.product_ratings);case"rating-low-to-high":return p.sort((t,d)=>t.product_ratings-d.product_ratings)}})(),limit:5});l.useEffect(()=>{o.goToPage(0),g("")},[s,i]),l.useEffect(()=>{g("")},[o.currentPage,c]);const y=t=>{g(a===t?"":t)};return e.jsxs(C,{className:"flex flex-col flex-1 w-full",children:[c>=768?e.jsx(ve,{columns:fe,dataSource:o.currentItems(),pagination:!1,locale:{emptyText:e.jsx(ge,{text:"No orders found"})},rowKey:t=>t.SKU}):e.jsx("div",{className:"flex flex-1 flex-col gap-5 mb-[26px]",children:o.currentItems().map(t=>e.jsx(F,{order:t,activeCollapse:a,handleCollapse:y},t.SKU))}),o.maxPage>1&&e.jsx(me,{pagination:o})]})},Me=()=>{const[s,i]=l.useState(T[0]),[r,c]=l.useState(A[0]),a=de(ne),[g,p]=l.useState(0),[w,o]=l.useState(0),[y,t]=l.useState(0),[d,G]=l.useState(0),[L,z]=l.useState([]),[S,R]=l.useState({shopId:a==null?void 0:a._id,limit:P,page:1});l.useEffect(()=>{R({shopId:a==null?void 0:a._id,limit:P,page:1})},[a]);const[B,{isLoading:Se,error:_e}]=oe(),M=async()=>{const h=await B(S),f=h==null?void 0:h.data;if(f){const{isPaid:q,isDelivered:V,isCanceled:Z,isRefunded:H,orders:E}=f==null?void 0:f.metadata;p(q),o(V),t(Z),G(H);const X=E.flatMap(n=>n.itemProducts),W=({isPaid:n,isDelivered:_,isCanceled:m,isRefunded:N})=>N===!0?"refunded":m===!0?"cancelled":_===!0?"confirmed":"completed",J=X.map((n,_)=>{const m=E.find(se=>se._id===n.order_id),{isPaid:N,isDelivered:Q,isCanceled:Y,isRefunded:ee}=m;return{...m,product_id:n._id,product_ratings:n.product_ratings,product_type:n.product_type,payment:{totalAmountPay:m.totalAmountPay,received:m.isPaid?m.totalAmountPay:0},status:W({isPaid:N,isDelivered:Q,isCanceled:Y,isRefunded:ee}),SKU:je()+_,product:n}});z(J)}};return l.useEffect(()=>{S.shopId&&M()},[S]),e.jsxs(e.Fragment,{children:[e.jsx(le,{title:"Orders"}),e.jsxs("div",{className:"flex flex-col flex-1 gap-5 md:gap-[26px]",children:[e.jsxs("div",{className:`w-full grid grid-cols-1 gap-4 md:grid-cols-2 md:gap-[26px] lg:grid-cols-4 lg:items-end
                     xl:grid-cols-6`,children:[e.jsx(ie,{wrapperClass:"lg:max-w-[275px] lg:col-span-2 xl:col-span-4",id:"ordersPeriodSelector",cb_setRangeDate:h=>{const f={gte:O(h[0]).format(),lt:O(h[1]).format()};R({shopId:a==null?void 0:a._id,limit:P,page:1,createdAt:f})}}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 md:gap-[26px] md:col-span-2",children:[e.jsx(D,{value:s,options:T,onChange:i,placeholder:"Product category"}),e.jsx(D,{value:r,options:A,onChange:c,placeholder:"Default sorting"})]})]}),e.jsxs("div",{className:"w-full widgets-grid grid-cols-1 xl:grid-cols-6",children:[e.jsx("div",{className:"xl:col-span-2",children:e.jsx(be,{})}),e.jsxs("div",{className:"widgets-grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 xl:col-span-4",children:[e.jsx(j,{title:"Paid",count:g*b,icon:e.jsx("i",{className:"icon-check-to-slot-solid"})}),e.jsx(j,{title:"Delivered",count:w*b,color:"green",icon:e.jsx("i",{className:"icon-list-check-solid"})}),e.jsx(j,{title:"Canceled",count:y*b,color:"red",icon:e.jsx("i",{className:"icon-ban-solid"})}),e.jsx(j,{title:"Refunded",count:d*b,color:"badge-status-bg",icon:e.jsx("i",{className:"icon-rotate-left-solid"})})]})]}),e.jsx(ye,{ordersProduct:L,category:s,sort:r})]})]})};export{Me as default};
